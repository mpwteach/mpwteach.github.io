<!DOCTYPE html>
<html>
  <head>
    <title>UNIX: Editors</title>
    <link rel="stylesheet" type="text/css" href="/styles/navbar.css?v=1.4" >
    <link rel="stylesheet" type="text/css" href="unixstyle.css">
    <link rel="icon" href="/images/favicon4.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
  </head>

  <body>

    <div class="mainheader">
      <h1>UNIX and Linux</h1>

      <ul class="topnav">
        <li><a href="index.html">Home</a></li>
        <li><a href="l1-intro.html">Introduction</a></li>
        <li><a href="l2-filesys.html">File System</a></li>
        <li><a href="l3-files.html">Files</a></li>
        <li><a href="l4-proc.html">Processes</a></li>
        <li><a href="l5-util.html">Utilities</a></li>
        <li><a class="active" href="l6-edit.html">Editors</a></li>
        <li><a href="l7-admin.html">Admin</a></li>
        <li><a href="l8-shell.html">Shell</a></li>
        <li class="right"><a href="/index.html">MPW Teach Home</a></li>
      </ul>
    </div>



    <h2>6.1 Introduction</h2>

    <div class="text">
      This section introduces the two most popular UNIX editors: 
      <b>vi</b> and <b>emacs</b>. For each editor, it covers:
      <ul>
        <li>Basic text input and navigation.</li>
        <li>Moving and copying text.</li>
        <li>Searching for and replacing text.</li>
        <li>Other useful commands.</li>
        <li>A quick-reference chart.</li>
      </ul>
    </div>

    <br>

    <h2>6.2.1 Introduction to vi</h2>
    
    <div class="text">
      <p>
        <b>vi</b> (pronounced "vee-eye", short for
        visual, or perhaps vile) is a display-oriented text editor based on an
        underlying line editor called <b>ex</b>. Although beginners usually find
        <b>vi</b> somewhat awkward to use, it is useful to learn because it is universally available
        (being supplied with all UNIX systems). It also uses standard alphanumeric
        keys for commands, so it can be used on almost any terminal or workstation
        without having to worry about unusual keyboard mappings. System administrators
        like users to use <b>vi</b> because it uses very few system resources.
      </p>

      <p>
        To start <b>vi</b>, enter:
      </p>
      <p class="terminal">
        $ vi filename<br>
      </p>
      <p>where <I>filename</I> is the name of the file you want
        to edit. If the file doesn't exist, <b>vi</b> will create it for you.
      </p>
    </div>


    <h2>6.2.2 Basic Text Input and Navigation in vi</h2>

    <div class="text">
      <p>
        The main feature that makes <b>vi</b> unique
        as an editor is its mode-based operation. <b>vi</b> has two modes: command
        mode and input mode. In command mode, characters you type perform actions
        (e.g. moving the cursor, cutting or copying text, etc.) In input mode,
        characters you type are inserted or overwrite existing text.
      </p>
      <p>
        When you begin <b>vi</b>, it is in command mode. To
        put <b>vi</b> into input mode, press <b>i </b>(insert). You can then
        type text which is inserted at the current cursor location; you can correct
        mistakes with the backspace key as you type.To get back into command mode,
        press ESC (the escape key). Another way of inserting text, especially useful
        when you are at the end of a line is to press <b>a</b> (append).
      </p>
      <p>
        In command mode, you are able to move the cursor around your document.
        <b>h</b>, <b>j</b>, <b>k</b> and <b>l</b> move the
        cursor left, down, up and right respectively (if you are lucky the arrow
        keys may also work). Other useful keys are <b>^</b> and <b>$</b> which
        move you to the beginning and end of a line respectively.
        <b>w</b> skips to the beginning of the next word and <b>b</b> skips back to the beginning
        of the previous word. To go right to the top of the document, press <b>1</b>
        and then <b>G</b>. To go the bottom of the document, press <b>G</b>.
        To skip forward a page, press <b>^F</b>, and to go back a page, press
        <b>^B</b>.
        To go to a particular line number, type the line number and press <b>G</b>,
        e.g. <b>55G</b> takes you to line 55.
      </p>
      <p>
        To delete text, move the cursor over the first character
        of the group you want to delete and make sure you are in command mode.
        Press <b>x</b> to delete the current character, <b>dw</b> to delete
        the next word, <b>d4w</b> to delete the next 4 words, <b>dd</b> to
        delete the next line, <b>4dd</b> to delete the next 4 lines, <b>d$</b>
        to delete to the end of the line or even <b>dG</b> to delete to the end
        of the document. If you accidentally delete too much, pressing <b>u</b>
        will undo the last change.
      </p>
      <p>
        Occasionally you will want to join two lines together.
        Press <b>J</b> to do this (trying to press backspace on the beginning
        of the second line does not have the intuitive effect!)
      </p>
    </div>


    <h2>6.2.3 Moving and Copying Text in vi</h2>

    <div class="text">
      <p>
        <b>vi</b> uses buffers to store text that is
        deleted. There are nine numbered buffers (1-9) as well as the undo buffer.
        Usually buffer 1 contains the most recent deletion, buffer 2 the next recent,
        etc.
      </p>
      <p>
        To cut and paste in <b>vi</b>, delete the text (using
        e.g. <b>5dd</b> to delete 5 lines). Then move to the line where you want
        the text to appear and press <b>p</b>. If you delete something else before
        you paste, you can still retrieve the delete text by pasting the contents
        of the delete buffers. You can do this by typing <b>1p</b>,<b>2p</b>,
        etc.
      </p>
      <p>
        To copy and paste, "yank" the text (using e.g. <b>5yy</b>
        to copy 5 lines). Then move to the line where you want the text to appear
        and press <b>p</b>.
      </p>
    </div>


    <h2>6.2.4 Searching for and Replacing Text in vi</h2>


    <div class="text">
      <p>
        In command mode, you can search for text by specifying
        regular expressions. To search forward, type <b>/</b> and then a regular
        expression and press enter. To
        search backwards, begin with a <b>?</b> instead of a <b>/</b>. To find
        the next text that matches your regular expression press <b>n</b>.
      </p>
      <p>
        To search and replace all occurences of pattern1 with
        pattern2, type <b>:%s/</b><I>pattern1</I><b>/</b><I>pattern2</I><b>/g</b>.
        To be asked to confirm each replacement, add a <b>c</b> to this substitution
        command. Instead of the <b>%</b> you can also give a range of lines (e.g.
        1,17) over which you want the substitution to apply.
      </p>
    </div>

    <h2>6.2.5 Other Useful vi Commands</h2>

    <div class="text">
      <p>
        Programmers might like the <b>:set number<IMG SRC="enter.gif" HEIGHT=15 WIDTH=27></b>
        command which displays line numbers (<b>:set nonumbe</b>r turns them
        off).
      </p>
      <p>To save a file, type <b>:w</b>.
        To save and quit, type <b>:wq</b>
        or press <b>ZZ</b>. To force a quit without saving type <b>:q!</b>
      </p>
      <p>
        To start editing another file, type <b>:e</b> filename .
      </p>
      <p>
        To execute shell commands from within vi, and then return
        to vi afterwards, type <b>:!</b><I>shellcommand</I>.
        You can use the letter <b>%</b> as a substitute for the name of the file
        that you are editing (so <b>:!echo %</b> prints the name of the current
        file).
      </p>
      <p>
        <b>.</b> repeats the last command.
      </p>
    </div>

    <h2>6.2.6 Quick reference for vi</h2>
    
    <table class="tablestyle2">
      <tr>
        <th>Command</th>
        <th>Description</th>
      </tr>

      <tr><td><b>Inserting and typing text:</b></td></tr>

      <tr>
        <td>i</td>
        <td>insert text (and enter input mode)</td>
      </tr>
      <tr>
        <td>a</td>
        <td>append text (to end of line)</td>
      </tr>
      <tr>
        <td>ESC</td>
        <td>re-enter command mode</td>
      </tr>
      <tr>
        <td>J</td>
        <td>join lines</td>
      </tr>

      <tr><td><b>Cursor movement:</b></td></tr>

      <tr>
        <td>h</td>
        <td>left</td>
      </tr>
      <tr>
        <td>j</td>
        <td>down</td>
      </tr>
      <tr>
        <td>k</td>
        <td>up</td>
      </tr>
      <tr>
        <td>l</td>
        <td>right</td>
      </tr>
      <tr>
        <td>^</td>
        <td>beginning of line</td>
      </tr>      
      <tr>
        <td>$</td>
        <td>end of line</td>
      </tr>
      <tr>
        <td>1 G</td>
        <td>top of document</td>
      </tr>
      <tr>
        <td>G</td>
        <td>end of document</td>
      </tr>
      <tr>
        <td>&lt;n&gt; G</td> 
        <td>go to line &lt;n&gt;</td>
      </tr>
      <tr>
        <td>^F</td>
        <td>page forward</td>
      <tr>
      <tr>
        <td>^B</td>
        <td>page backward</td>
      </tr>
      <tr>
        <td>w</td>
        <td>word forwards</td>
      </tr>
      <tr>
        <td>b</td>
        <td>word backwards</td>
      </tr>

      <tr><td><b>Deleting and moving text:</b></td></tr>

      <tr>
        <td>Backspace</td>
        <td>delete character before cursor (only works in insert mode)</td>
      </tr>
      <tr>
        <td>x</td>
        <td>delete character under cursor</td>
      </tr>
      <tr>
        <td>dw</td>
        <td>delete word</td>
      </tr>
      <tr>
        <td>dd</td>
        <td>delete line (restore with p or P)</td>
      </tr>
      <tr>
        <td>&lt;n&gt; dd</td>
        <td>delete n lines</td>
      </tr>
      <tr>
        <td>d$</td>
        <td>delete to end of line</td>
      </tr>
      <tr>
        <td>dG</td>
        <td>delete to end of file</td>
      </tr>
      <tr>
        <td>yy</td>
        <td>yank/copy line (restore with p or P)</td>
      </tr>
      <tr>
        <td>&lt;n&gt; yy</td>
        <td>yank/copy &lt;n&gt;lines</td>
      </tr>

      <tr><td><b>Search and replace:</b></td></tr>

      <tr>
        <td>%s/&lt;search string&gt;/&lt;replace string&gt;/g</td>
      </tr>

      <tr><td><b>Miscellaneous:</b></td></tr>

      <tr>
        <td>u</td>
        <td>undo</td>
      </tr>
      <tr>
        <td>:w</td>
        <td>save file</td>
      </tr>
      <tr>
        <td>:wq</td>
        <td>save file and quit</td>
      </tr>
      <tr>
        <td>ZZ</td>
        <td>save file and quit</td>
      </tr>
      <tr>
        <td>:q!</td> 
        <td>quit without saving</td>
      </tr>

    </table>
    
    <h2>6.3.1 Introduction to emacs</h2>
    
    <div class="text">
      <p>
        <b>emacs </b>is a popular editor for UNIX,
        based operating systems. Unlike <b>vi</b>, it is not a standard
        UNIX system utility, but is available from the Free Software Foundation.
      </p>
      <p>
        An <b>emacs</b> zealot will tell you how <b>emacs</b>
        provides advanced facilities that go beyond simple insertion and deletion
        of text: you can view two are more files at the same time, compile and
        debug programs in almost any programming language, typeset documents, run
        shell commands, read manual pages, email and news and even browse the web
        from inside <b>emacs</b>.
      </p>
      <p>
        <b>emacs</b> is also very flexible - you
        can redefine keystrokes and commands easily, and (for the more ambitious)
        you can even write Lisp programs to add new commands and display modes
        to <b>emacs</b>, since <b>emacs</b> has its own Lisp interpreter. In
        fact most of the editing commands of Emacs are written in Lisp already;
        the few exceptions are written in C for efficiency. However, users do not
        need to know how to program Lisp to use <b>emacs</b> (while it is true
        that only a programmer can write a substantial extension to <b>emacs</b>,
        it is easy for anyone to use it afterwards).
      </p>
      <p>
        Critics of <b>emacs</b> point out that it uses a relatively
        large amount of system resources compared to <b>vi</b> and that it has
        quite a complicated command structure (joking that <b>emacs</b> stands
        for Escape-Meta-Alt-Control-Shift).
      </p>
      <p>
        In practice most users tend to use both editors - <b>vi</b>
        to quickly edit short scripts and programs and <b>emacs</b> for more
        complex jobs that require reference to more than one file simultaneously.
      </p>
      <p>
        On UNIX systems, <b>emacs</b> can run in graphical mode
        under the X Windows system, in which case some helpful menus and mouse
        button command mappings are provided. However, most of its facilities are
        also available on a text terminal.
      </p>
      <p>To start <b>emacs</b>, enter:
      <p class="terminal">$ emacs <I>filename</I></p>
      <p>where <I>filename</I> is the name of the file you want
        to edit. If the file doesn't exist, <b>emacs</b> will create it for you.
      </p>
    </div>


    <h2>6.3.2 Basic Text Input and Navigation in emacs</h2>
    
    <div class="text">
      <p>
        Text input and navigation in <b>emacs</b> is
        mostly a matter of using the arrow keys to position the cursor and typing
        some text. Issuing more complex <b>emacs</b> commands usually involves
        pressing the Ctrl key (sometimes also labelled Control or Ctl) or the Meta
        key (sometimes also labelled Alt). <b>emacs</b> commands are usually
        described in this way:
      </p>
      <ul>
        <li>
          <b>C-&lt;chr&gt;</b> means hold the Ctrl key while typing
          the character <b>&lt;chr&gt;</b>. Thus, <b>C-f</b> would be: hold the
          Ctrl key and type <b>f</b>.
        </li>

        <li>
          <b>M-&lt;chr&gt;</b> means hold the Meta or Alt key
          down while typing <b>&lt;chr&gt;</b>. If there is no Meta or Alt key, instead
          press and release the ESC key and then type <b>&lt;chr&gt;</b>.</li>
      </ul>

      <p>
        One initially annoying feature of <b>emacs</b> is that
        its help facility has been installed on <b>C-h</b> (Ctrl h). Unfortunately
        this is also the code for the backspace key on most systems. You can, however,
        easily make the key work as expected by creating a <b>.emacs</b> file
        (a file always read on start up) in your home directory containing the
        following line:
      <p><b>(global-set-key "\C-h" 'backward-delete-char-untabify)</b>
      <p>
        <a href="dotemacs">Here</a> is a <b>.emacs</b> file that
        contains this line as well as several other useful facilities (see Section 6.3.6).
      </p>
      <p>
        To access the help system you can still type <b>M-x help</b>
        or (for a comprehensive tutorial) <b>M-x help-with-tutorial</b>
      </p>
      <p>
        Useful navigation commands are <b>C-a</b> (beginning
        of line), <b>C-e</b> (end of line), <b>C-v</b> (forward page), <b>M-v</b>
        (backwards page), <b>M-&lt;</b> (beginning of document) and <b>M-&gt;</b>
        (end of document). <b>C-d </b>will delete the character under the cursor,
        while <b>C-k</b> will delete to the end of the line. Text deleted with
        <b>C-k</b> is placed in a buffer which can be "yanked" back later with <b>C-y</b>.
      </p>
    </div>


    <h2>6.3.3 Moving and Copying Text in emacs</h2>
    
    <div class="text">
      <p>  
        The easiest way to cut and paste text is to go
        to the start of the text and press <b>C-k</b> until you have deleted
        the text you want. Then move to the spot where you want to paste the text
        and press <b>C-y</b> to restore the text. If you make a mistake, <b>C-u</b>
        will undo the change (<b>emacs</b> supports several levels of undo).
      </p>
      <p>
        Another way to delete a chunk of text is to go the start of the text and
        press <b>C-SPC</b> (SPC is the spacebar; this sets a mark). Then go to
        the end of the text you wish to delete and press <b>C-w</b>. Restore
        the text in the right spot with <b>C-y</b>.
      </p>
      <p>
        To copy and paste, delete the target text as above, and
        then use <b>C-y</b> twice (once to restore the original text, and once
        to create the copy).
      </p>
    </div>


    <h2>6.3.4 Searching for and Replacing Text in emacs</h2>

    <div class="text">
      <p>
        To search forwards and backwards incrementally,
        use <b>C-s</b> and <b>C-r</b> respectively. Pressing <b>C-s</b> or <b>C-r</b>
        again will repeat the operation. When you have found the text you want,
        press enter, or press
        <b>C-g</b> to cancel the operation and return your cursor to the position where the
        search started.
      </p>
      <p>
        To replace a string, type <b>M-x replace-string</b>
        (you may want to modify your <b>.emacs</b> file so that this command
        is on <b>C-x r</b>). <b>M-%</b> performs a query search and replace.
      </p>
    </div>

    <h2>6.3.5 Other Useful emacs Commands</h2>

    <div class="text">
      <p>
        Pressing <b>C-g</b> will cancel any <b>emacs</b>
        command in progress.
      </p>
      <p>
        To save a file, press <b>C-x C-s</b>. To start
        editing a new file, press <b>C-x C-f</b>.
      </p>
      <p>To bring up two windows (or "buffers" in emacs-speak),
        press <b>C-x 2</b> (<b>C-x 1</b> gets you back to 1). <b>C-x o</b>
        switches between buffers on the same screen. <b>C-x b</b> lets you switch
        between all active buffers, whether you can see them or not. <b>C-x C-k</b>
        deletes a buffer that you are finished with.
      </p>
      <p>
        <b>M-x shell</b> brings up a UNIX shell inside a buffer (you may like to put this on <b>C-x C-u</b>).
        <b>M-x goto-line</b> skips to a particular line (you may like to put this on <b>C-x g</b>).
        <b>M-x compile</b> will attempt to compile a program (using the <b>make</b> utility or 
        some other command that you can specify). If you are doing a lot of programming you will probably want
        to put this on a key like <b>C-x c</b>.
        <b>M-q</b> will reformat a paragraph.
        <b>C-x C-c </b>quits emacs.
      </p>
    </div>


    <h2>6.3.6 Quick reference for emacs</h2>


    <table class="tablestyle2">
      <tr>
        <th>Command</th>
        <th>Description</th>
      </tr>

      <tr>
        <td><b>Cursor movement:</b></td>
      </tr>     
      <tr>
        <td>C-a<td>
        <td>beginning of line</td>
      <tr>
        <td>C-e</td>
        <td>end of line</td>
      <tr>
        <td>C-&lt;</td>
        <td>top of document</td>
      </tr>
      <tr>
        <td>C-&gt;</td>
        <td>end of document</td>
      </tr>
      <tr>
        <td>M-x goto-line</td>
        <td>Go to line</td>
      </tr>
      <tr>
        <td>C-v</td>
        <td>page forward</td>
      </tr>
      <tr>
        <td>M-v</td>
        <td>page backward</td>
      </tr>

      <tr>
        <td><b>Deleting and moving text:</b></td>
      </tr>
      <tr>
        <td>Backspace</td> 
        <td>delete character before cursor</td>
      </tr>
      <tr>
        <td>C-d</td>
        <td>delete character under cursor</td>
      </tr>
      <tr>
        <td>M-d</td>
        <td>delete word</td>
      </tr>
      <tr>
        <td>C-k</td>
        <td>delete to end of line(s) (restore with C-y)</td>
      </tr>
      <tr>
        <td>C-y</td>
        <td>yank/restore after C-k or C-w</td>
      </tr>
      <tr>
        <td>C-SPC</td>
        <td>set mark</td>
      </tr>
      <tr>
        <td>C-w</td>
        <td>delete from mark to cursor (restore with C-y)</td>
      </tr>

      <tr><td><b>Search and replace:</b></td></tr>
      <tr>
        <td>C-s</td>
        <td>incremental search forward</td>
      </tr>
      <tr>
        <td>C-r</td>
        <td>incremental search backward</td>
      </tr>
      <tr>
        <td>C-%</td>
        <td>query replace</td>
      </tr>
      <tr>
        <td>M-x replace-string &lt;searchstr&gt; enter &lt;replstr&gt;</td>
        <td>replace string</td>
      </tr>

      <tr><td><b>Miscellaneous:</b></td></tr>
      <tr>
        <td>C-x u</td>
        <td>undo</td>
      </tr>
      <tr>
        <td>C-x C-s</td>
        <td>save file</td>
      </tr>
      <tr>
        <td>C-x C-f</td>
        <td>find file</td>
      </tr>
      <tr>
        <td>C-x 2</td>
        <td>split to 2 windows</td>
      </tr>
      <tr>
        <td>C-x 1</td>
        <td>merge to 1 window</td>
      </tr>
      <tr>
        <td>C-x o</td>
        <td>switch between windows</td>
      </tr>
      <tr>
        <td>C-x b</td>
        <td>switch buffers</td>
      </tr>
      <tr>
        <td>M-q</td>
        <td>reformat paragraph</td>
      </tr>
      <tr>
        <td>C-x C-c</td>
        <td>quit</td>
      </tr>
      <tr>
        <td>C-x h</td>
        <td>mark whole buffer, useful to apply a command to whole buffer</td>
      </tr>
      <tr>
        <td>C-M-\</td>
        <td>indent region</td>
      </tr>     


      <tr><td><b>Useful customisable keys (configured using the provided <a href="dotemacs">.emacs</a> file):</b></td></tr>
      
      <tr>
        <td>C-z</td>
        <td>undo</td>
      </tr>
      <tr>
        <td>C-x g</td>
        <td>goto line</td>
      </tr>
      <tr>
        <td>C-x c</td>
        <td>compile program (useful with C-x 2)</td>
      </tr>
    </table>


    <h2>6.4 Other UNIX editors</h2>

    <div class="text">
      <p>
        There are many other editors for UNIX systems.
        Two popular alternatives to <b>vi</b> and <b>emacs</b> are <b>nano</b> and <b>pico</b>.
      </p>
    </div>

  </body>


</html>
